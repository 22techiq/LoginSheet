<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Login</title>
<!-- Prevent iframe embedding -->
<meta http-equiv="X-Frame-Options" content="DENY">
<style>
body{font-family:Arial;background:#f4f6f9;display:flex;justify-content:center;align-items:center;height:100vh;}
.box{background:white;padding:30px;width:350px;border-radius:8px;box-shadow:0 10px 25px rgba(0,0,0,0.1);}
input,button{width:100%;padding:10px;margin:8px 0;}
button{background:#1a73e8;color:white;border:none;border-radius:5px;cursor:pointer;}
a{font-size:14px;}
.msg{color:red;font-size:14px;}



/* Spinner animation */
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
.spinner {
  width:16px;
  height:16px;
  border:3px solid #f3f3f3;
  border-top:3px solid #1a73e8;
  border-radius:50%;
  animation:spin 1s linear infinite;
  display:inline-block;
  vertical-align:middle;
  margin-right:6px;
}
</style>
</head>
<body>

<div class="box">
<h2>Login</h2>

<input type="email" id="email" placeholder="Email" required>
<input type="password" id="password" placeholder="Password" required>

<button onclick="login()">Login</button>

<div class="msg" id="msg"></div>

<a href="forgot.html">Forgot Password?</a><br>
<a href="register.html">Create Account</a>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbxAVz1fgbNvB0MG6dCMPnpZ1QXOqZr_CzV_uaSzS3GWHTyXs8T644B2H93UaJ9xYgK3/exec";

async function login(){

  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();

  if(!email || !password){
    document.getElementById("msg").innerText = "Fill all fields.";
    return;
  }


//Added spinner
document.getElementById("msg").innerHTML = '<span class="spinner"></span> Logging in...';



  const res = await fetch(API,{
    method:"POST",
    body:JSON.stringify({
      action:"login",
      email:email,
      password:password,
      ip:"",
      userAgent:navigator.userAgent
    })
  });

  const data = await res.json();

  if(data.status === "success"){
    sessionStorage.setItem("authToken",data.token);
    window.location.href="success.html";
  }
  else if(data.status === "locked"){
    document.getElementById("msg").innerText="Account locked temporarily.";
  }
  else{
    document.getElementById("msg").innerText="Invalid email or password.";
  }
}
</script>
<script>
/* =================================
   1. Disable Right Click
================================= */
document.addEventListener("contextmenu", e => e.preventDefault());

/* =================================
   2. Disable Copy / Cut / Paste
================================= */
["copy", "cut", "paste", "dragstart"].forEach(evt => {
  document.addEventListener(evt, e => e.preventDefault());
});

/* =================================
   3. Block DevTools Shortcuts
================================= */
document.addEventListener("keydown", function (e) {
  if (
    e.key === "F12" ||
    (e.ctrlKey && e.shiftKey && ["I","J","C"].includes(e.key)) ||
    (e.ctrlKey && e.key === "U")
  ) {
    e.preventDefault();
    return false;
  }
});

/* =================================
   4. DevTools Size Detection
================================= */
setInterval(() => {
  const widthDiff  = window.outerWidth - window.innerWidth;
  const heightDiff = window.outerHeight - window.innerHeight;

  if (widthDiff > 160 || heightDiff > 160) {
    document.body.innerHTML =
      "<h2 style='color:red;margin-top:20%'>Access Denied. Kindly use legitimate means to access project source code!</h2>";
  }
}, 1000);

/* =================================
   5. Console Open Detection
================================= */
(function () {
  const element = new Image();
  Object.defineProperty(element, "id", {
    get: function () {
      document.body.innerHTML =
        "<h2 style='color:red;margin-top:20%'>Inspection Blocked</h2>";
    }
  });
  console.log(element);
})();

/* =================================
   6. Anti-Debugger Trap
================================= */
setInterval(function () {
  debugger;
}, 2000);

/* =================================
   7. Hide Source via Visibility Change
================================= */
document.addEventListener("visibilitychange", function () {
  if (document.hidden) {
    document.body.style.display = "none";
  } else {
    document.body.style.display = "block";
  }
});

/* =================================
   8. Disable View Source via Mouse
================================= */
document.onmousedown = function (e) {
  if (e.button === 2) return false;
};
</script>

</body>
</html>
